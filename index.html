<!DOCTYPE html>
<html>
  <head>
    <title>Buscador de Versículos Bíblicos</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        max-width: 600px;
        margin: auto;
        background-color: #f9f9f9;
        color: #333;
        line-height: 1.6;
      }
      h1 {
        text-align: center;
        color: #4CAF50;
      }
      input, button {
        width: 100%;
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 16px;
      }
      button {
        background-color: #4CAF50;
        color: white;
        border: none;
        cursor: pointer;
      }
      button:hover {
        background-color: #45a049;
      }
      ul {
        list-style-type: none;
        padding: 0;
      }
      li {
        padding: 15px;
        border: 1px solid #ccc;
        margin-bottom: 10px;
        border-radius: 4px;
        background-color: #fff;
      }
    </style>
  </head>
  <body>
    <h1>Buscador de Versículos Bíblicos</h1>
    <input
      type="text"
      id="searchInput"
      placeholder="Escribe Libro Capítulo:Versículo (ej. Gálatas 1:1)"
    />
    <button id="searchButton">Buscar</button>
    <ul id="results"></ul>

    <script>
      // URLs de los archivos JSON
      const urls = [
        "https://raw.githubusercontent.com/Angelos2024/torah-Yehoshua/main/galatas.json"
      ];

      const searchInput = document.getElementById("searchInput");
      const searchButton = document.getElementById("searchButton");
      const resultsContainer = document.getElementById("results");

      // Función para normalizar texto
      function normalizeText(text) {
        return text
          .normalize("NFD")
          .replace(/[\u0300-\u036f]/g, "")
          .toLowerCase()
          .replace(/\s+/g, " ");
      }

      // Función para cargar datos JSON directamente
      async function fetchJsonData(url) {
        try {
          const response = await fetch(url);
          if (!response.ok) {
            throw new Error(`Error al cargar el JSON: ${url}`);
          }
          return await response.json();
        } catch (error) {
          console.error(`Error:`, error);
          return null;
        }
      }

      // Cargar y combinar datos de todas las URLs
      async function fetchAllJsonData() {
        const allData = {};
        for (const url of urls) {
          const data = await fetchJsonData(url);
          if (data) {
            Object.assign(allData, data);
          }
        }
        return allData;
      }

      // Buscar y mostrar versículos
      async function searchVerses(query) {
        const datos = await fetchAllJsonData();
        if (!datos) return;

        resultsContainer.innerHTML = "";
        const normalizedQuery = normalizeText(query);
        const match = normalizedQuery.match(/^([\w\s]+)\s(\d+)(?::(\d+))?$/);

        if (match) {
          const libro = match[1].trim();
          const capitulo = match[2];
          const versiculo = match[3];

          const libroEncontrado = Object.keys(datos).find(
            key => normalizeText(key) === normalizeText(libro)
          );

          if (libroEncontrado) {
            const capitulos = datos[libroEncontrado];
            if (capitulos[capitulo]) {
              if (versiculo) {
                const texto = capitulos[capitulo][versiculo];
                if (texto) {
                  resultsContainer.innerHTML = `
                    <li>${libroEncontrado} ${capitulo}:${versiculo} - ${texto}</li>
                  `;
                } else {
                  resultsContainer.innerHTML = "<li>Versículo no encontrado.</li>";
                }
              } else {
                Object.entries(capitulos[capitulo]).forEach(([numVerso, textoVerso]) => {
                  const li = document.createElement("li");
                  li.innerHTML = `${libroEncontrado} ${capitulo}:${numVerso} - ${textoVerso}`;
                  resultsContainer.appendChild(li);
                });
              }
            } else {
              resultsContainer.innerHTML = "<li>Capítulo no encontrado.</li>";
            }
          } else {
            resultsContainer.innerHTML = "<li>Libro no encontrado.</li>";
          }
        } else {
          resultsContainer.innerHTML =
            "<li>Formato incorrecto. Usa: Libro Capítulo:Versículo (ej. Gálatas 1:1).</li>";
        }
      }

      // Eventos
      searchButton.addEventListener("click", () => {
        const query = searchInput.value.trim();
        if (query.length > 0) searchVerses(query);
      });

      searchInput.addEventListener("keypress", event => {
        if (event.key === "Enter") {
          const query = searchInput.value.trim();
          if (query.length > 0) searchVerses(query);
        }
      });
    </script>
  </body>
</html>
