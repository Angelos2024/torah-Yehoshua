<!doctype html>
                            <head>
                                <meta charset='utf-8'>
                                <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

                                <title>Snippet - BBBootstrap</title>
                                <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css' rel='stylesheet'>
                       
                            
                                <script type='text/javascript'>var myLink = document.querySelector('a[href="#"]');
                                myLink.addEventListener('click', function(e) {
                                  e.preventDefault();
                                });</script>

       <link rel="stylesheet" href="css/estiloparalelo.css">
       <link rel="stylesheet" href="css/estilo.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">



                                <style>::-webkit-scrollbar {
                                  width: 8px;
                                }
                                /* Track */
                                ::-webkit-scrollbar-track {
                                  background: #f1f1f1; 
                                }
                                 
                                /* Handle */
                                ::-webkit-scrollbar-thumb {
                                  background: #888; 
                                }
                                
                                /* Handle on hover */
                                ::-webkit-scrollbar-thumb:hover {
                                  background: #555; 
                                } body{

    background-color:#6D3961;
  padding: 10px;
  margin: 0;
  overflow-x: hidden; /* Evita desplazamiento lateral */


}

.form-inputs{
    position:relative;
}
.form-inputs .form-control{
    height:45px; 
}

.form-inputs .form-control:focus{
    box-shadow:none;
    border:1px solid #000;
}
.nav-link {
  padding: 0 !important;
  }

.form-inputs i{
    position:absolute;
    right:10px;
    top:15px;
}

.shop-bag{
    background-color:#000;
    color:#fff;
    height:50px;
    width:50px;
    font-size:25px;
    display:flex;
    border-radius:50%;
    align-items:center;
    justify-content:center;
}

.qty{
    font-size:12px;
}

    #mySidebar {
      width: 0; /* Ancho inicial */
  position: absolute; /* Sidebar fijo, pero sin necesidad de especificar top, right */
  z-index: 10;
  height: 100%;
  top: 115px; /* Espacio desde la parte superior */
  right: 0; /* Posición en la derecha */
  background-color: #111;
  overflow-x: hidden;
  overflow-y: auto; /* Añade scroll vertical si el contenido es mayor que la ventana */
  transition: width 0.4s;
transition: width 0.4s ease, transform 0.4s ease;
  overflow-x: hidden;
  color: white;
      transform: translateX(100%);
    }

    #mySidebar.open {
      transform: translateX(0);
        width: 32%;
  height: 600px;
  margin-top: 25px;
  top: 90px;
    }
#main {
  transition: margin-right 0.3s;
  padding: 2px;
}
#main.shifted {
  margin-right: 10%; /* Igual al ancho del sidebar izquierdo */
  transition: margin-right 0.4s ease; /* Animación suave */
}
  
  #searchTermContainer {
    font-size: 18px;
    padding: 10px;
    background-color: #f8f9fa;
    border: 1px solid #ddd;
    border-radius: 5px;
  }



    #contenidoSidebar {
      padding: 1rem;
    }

    #imgmaterial {
      cursor: pointer;
        transition: transform 0.3s ease; /* Suaviza la animación al pasar el mouse */
    }
    #imgmaterial:hover {
  transform: scale(1.2); /* Amplía la imagen ligeramente al pasar el mouse */
 }
 @media (max-width: 768px) {
  #imgmaterial, #imgparalelo, #imgcopiar {
    position: relative;  /* Cambia de absoluta a relativa para que se adapten mejor */
    left: 0;             /* Ajusta el desplazamiento a la izquierda */
    top: auto;           /* Elimina cualquier desplazamiento vertical */
    margin-top: 10px;    /* Espaciado superior para que no se solapen */
  }
  </style>
</head>
<body class="container-fluid">



<section class="header border-bottom bg-white">
  <div class="container-fluid">
    <div class="row p-2 pt-3 pb-3 d-flex align-items-center">
      <!-- Logo -->
      <div class="col-md-2 col-4">
        <img class="d-none d-md-flex" src="https://imgur.com/5xmewUr.png" width="45" alt="Logo">
      </div>
      
      <!-- Buscador y Botón -->
      <div class="col-md-10 col-8">
        <div class="d-flex align-items-center justify-content-between">
         <!-- Campo de Búsqueda -->
<div class="flex-grow-1 me-2">
  <div class="input-group">
    <!-- Input de Búsqueda -->
    <input 
      class="form-control" 
      type="text" 
      id="searchInput" 
      placeholder="Escribe Libro Capítulo:Versículo (ej. Gálatas 1:1)" />
    
    <!-- Botón de Búsqueda -->
    <button 
      id="searchButton" 
      class="btn btn-dark"
      style="transition: box-shadow 0.3s ease; margin-left: 3px; box-shadow: 0 0 0 rgba(0, 0, 0, 0);"
  onmouseover="this.style.boxShadow='0 0 10px rgba(0, 0, 0, 0.8)'"
  onmouseout="this.style.boxShadow='0 0 0 rgba(0, 0, 0, 0)'"
>
      Buscar
    </button>

  </div>

</div>


<style>
  /* Efecto de iluminación en el botón */
  #searchButton:hover {
    box-shadow: 0 0 10px rgba(0, 123, 255, 0.8);
  }

  /* Estilo adicional para el input */
  #searchInput {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  }

  /* Estilo adicional para el botón */
  #searchButton {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }
</style>



          <!-- Botón de Comentarios -->

  <div>
  <button id="toggleComentarios" class="btn btn-primary custom-btn">
    Mostrar Comentarios
  </button>
</div>

<style>
  /* Estilo base del botón */
  .custom-btn {
    background-color: #000 !important; /* Fondo negro */
    color: #fff; /* Texto blanco */
    border: 2px solid #000 !important; /* Borde inicial negro */
    transition: background-color 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
  }

  /* Efecto hover */
  .custom-btn:hover {
    background-color: #6D3961 !important; /* Fondo al pasar el mouse */
    border-color: #6D3961 !important; /* Borde del mismo color que el fondo */
    box-shadow: 0 0 10px #6D3961; /* Sombra de color */
  }

  /* Para evitar borde azul en el enfoque */
  .custom-btn:focus {
    box-shadow: none !important; /* Sin sombra azul de Bootstrap */
    outline: none; /* Sin borde adicional */
  }
</style>


        </div>
        
        <!-- Contenedor de Comentarios -->
        <div id="comentarios" style="display: none; z-index: 2; margin-top: 68px;">
          <h3>Comentarios</h3>
          <div id="contenidoComentarios">
            <!-- Aquí se cargarán los comentarios -->
          </div>
        </div>


        <!-- Contenedor Adicional -->
        
      </div>
    </div>
  </div>
 

</section>

 


<header class="section-header">
  <nav class="navbar navbar-light bg-light d-flex justify-content-between align-items-center px-3" style="padding: 5px 10px; height: 33px;">
  
  <!-- Contenedor de los botones -->
    <div class="d-flex align-items-center gap-4">
       <!-- Botón de Contenido Paralelo -->
      <a href="#" class="nav-link" data-bs-toggle="tooltip" data-bs-placement="top" title="Paralelo">
        <img id="imgparalelo" src="https://i.imgur.com/xB2Fvor.png" alt="Contenido paralelo" onclick="toggleParaleloSidebar()" style="width: 31px; height: 32px; margin-left: 45px; margin-top:-5px;" />
      </a>

 <!-- Botón de Copiar -->
      <a href="#" class="nav-link" data-bs-toggle="tooltip" data-bs-placement="top" title="Copiar">
        <img id="imgcopiar" src="https://i.imgur.com/YaVe5C3.png" alt="Copiar contenido" onclick="copiarContenido()" style="width: 30px; height: 30px; margin-left: 40px; margin-top:-8px;" />
      </a>
    

        <!-- Dropdown -->

<div class="container">

    <div class="dropdown" style="margin-left: -10px;">
      <button class="btn btn-dark dropdown-toggle custom-dropdown-btn"  type="button" data-bs-toggle="dropdown"
        id="dropdownButton" 
        onclick="toggleDropdownMenu()">
        Libros de la Biblia
      </button>
      <div 
        class="dropdown-menu custom-dropdown-content" 
        id="dropdownMenu" 
        style="display: none;">
        <a class="dropdown-item" href="#">Según Marcos</a>
        <a class="dropdown-item" href="#">Carta a los Romanos</a>
        <a class="dropdown-item" href="#" data-libro="Gálatas">Carta a los Gálatas</a>
        <a class="dropdown-item" href="#" data-libro="1Tesalonicenses">1 Tesalonicenses</a>
        <a class="dropdown-item" href="#">2 Tesalonicenses</a>
        <a class="dropdown-item" href="#" data-libro="Hebreos">Carta a los Hebreos</a>
        <a class="dropdown-item" href="#">Revelación Apocalipsis</a>
      </div>
    </div>
  </div>
</div>
</div>


<style>


/* Botón principal */
.custom-dropdown-btn {
  font-size: 14px;
  margin-top: -11px;
  font-weight: bold;
  border: none;
  border-radius: 5px;
  padding: 1px 15px;
  cursor: pointer;
  transition: background-color 0.3s ease;
background-color: #000 !important; /* Fondo negro */
    color: #fff; /* Texto blanco */
    border: 2px solid #000 !important; /* Borde inicial negro */
    transition: background-color 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
}


.custom-dropdown-btn:hover {
  background-color: #6D3961 !important; /* Fondo al pasar el mouse */
    border-color: #6D3961 !important; /* Borde del mismo color que el fondo */
    box-shadow: 0 0 10px #6D3961; /* Sombra de color */
}

/* Contenedor del menú */
 .custom-dropdown-content {
    position: absolute;
    background-color: #ffffff;
    min-width: 200px;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    border-radius: 5px;
    overflow: hidden;
    z-index: 1;
  } 

/* Estilo de los enlaces dentro del menú */
.custom-dropdown-content a {
  color: #6D3961;
  padding: 10px 15px;
  text-decoration: none;
  display: block;
  font-size: 14px;
}

.custom-dropdown-content a:hover {
  background-color: #000;
  color: #fff;
}

</style>

       

 <!-- Botón de Menú (Aparato Crítico) -->
    <a href="#" class="nav-link" data-bs-toggle="tooltip" data-bs-placement="top" title="Aparato crítico">
  <img id="imgmaterial" src="https://i.imgur.com/oJRwGnT.png" alt="Menú" style="width: 30px; height: 30px; margin-right:100px; margin-top:-8px;" onclick="toggleSidebar()" />
    </a>
  </nav>
</header>

<div class="container" class="tema-uno" style="  font-family: Arial, sans-serif;
    padding: 20px;
   max-width: 600px !important;
    margin: auto;
    color: #333;
    line-height: 1.6;">

<!-- Botones de Página -->
<div class="navbar-nav d-flex align-items-center">
  <!-- Botón de Página Anterior -->
  <button 
    id="prevPage" 
    class="btn border-0 bg-transparent p-0" 
    style="position: fixed; left: 215px; top: 60%; width: 60px; height: 60px; display: none;">
    <div style="background-color: #ffffff; border-radius: 10px; width: 45%; height: 100%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
      <img src="https://imgur.com/t81IpES.png" alt="Página Anterior" style="width: 50%; height: 50%; object-fit: contain;">
    </div>
  </button>

  <!-- Botón de Página Siguiente -->
  <button 
    id="nextPage" 
    class="btn border-0 bg-transparent p-0" 
    style="position: fixed; right: 282px; top: 60%; width: 60px; height: 60px; display: none;">
    <div style="background-color: #ffffff; border-radius: 10px; width: 45%; height: 100%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
      <img src="https://imgur.com/t81IpES.png" alt="Página Siguiente" style="width: 50%; height: 50%; object-fit: contain; transform: scaleX(-1);">
    </div>
  </button>
</div>





<div id="myDIV"  style="flex-shrink: 0; width: 250px;">
  <div id="searchTermContainer" style="font-weight: bold; margin-bottom: 10px;"></div>
  <h5>Resultados</h5>
  
    <ul id="countResults" style="
    margin-top: -23px;
    list-style-type: none;
    padding: 0;
    margin-bottom: 10px;
    width: 100%;
    "></ul>
</div>
<style>
h5 {
  background-color: white;
    font-size: 18px;
    font-weight: bold;
    color: #000; /* Negro */
    text-align: center;
    padding: 10px;
    border-bottom: 7px solid #333; /* Línea sutil debajo */
}

#countResults {
    margin-top: -23px;
    background: #f8f9fa; /* Color de fondo suave */
    border: 1px solid #ddd; /* Borde sutil */
    border-radius: 5px; /* Bordes redondeados */
    padding: 5px;
    max-width: 300px; /* Ajusta el ancho máximo */
    list-style: none; /* Quita los puntos de la lista */
}


#results li {
    padding: 15px;
    border: 1px solid #ccc;
    margin-bottom: -13px;
    border-radius: 4px;
    background-color: #fff;
    width: calc(100% + 80px);
    margin-left: -90px;
    margin-top: 20px;

}
#countResults ul {
  list-style-type: none;
    padding: 0;
    margin-bottom: 10px;
    width: 100%;
}

#countResults li {
    padding: 5px 10px;
    border-bottom: 1px solid #ddd; /* Separadores entre elementos */
    cursor: pointer;
    transition: background 0.3s;
}

#countResults li:last-child {
    border-bottom: none; /* Quitar el borde del último elemento */
}

#countResults li:hover {
    background: #e2e6ea; /* Cambio de color al pasar el mouse */
}

#countResults .nested {
    display: none; /* Inicialmente oculto */
    padding-left: 15px;
}

#countResults .expandable {
    font-weight: bold;
    color: #333;
}

#countResults .expandable:hover {
    color: #007bff; /* Azul al pasar el mouse */
}


</style>

  

 <div class="tooltip copiar-tooltip">
  <img id="imgcopiar" src="https://i.imgur.com/YaVe5C3.png" 
       alt="Copiar contenido" 
       onclick="copiarContenido()" />
  <span class="tooltiptext">Copiar</span>
</div>
 <div class="tooltip material-tooltip">
<img id="imgmaterial" src="https://i.imgur.com/oJRwGnT.png" alt="Menú" onclick="toggleSidebar()">
<span class="tooltiptext">aparato crítico</span>
</div>

 <!-- Tooltip para "paralelo" -->
    <div class="tooltip paralelo-tooltip">
      <img id="imgparalelo" src="https://i.imgur.com/xB2Fvor.png" 
          alt="Contenido paralelo" 
           onclick="toggleParaleloSidebar()" />
      <span class="tooltiptext">Paralelo</span>
    </div>


 <div id="main">  


 <!-- Sidebar -->
   
<div id="mySidebar" class="col-md-3">
      <div id="menuSidebar" class="p-3">

        <button onclick="mostrarSeccion('critico')">Aparato Crítico NA28</button>
        <button onclick="mostrarSeccion('mapas')">Mapas</button>
      </div>
      <div id="contenidoSidebar" class="p-3">
        <div id="critico" class="seccionSidebar" style="display: none;">
          <p>Contenido del Aparato Crítico NA28</p>
        </div>
        <div id="mapas" class="seccionSidebar" style="display: none;">
          <p><a href="#" onclick="abrirModal('https://i.imgur.com/kYBZVlB.jpeg')">Mapa de los pueblos</a></p>
          <p><a href="#" onclick="abrirModal('https://i.imgur.com/zLScQV2.png')">Mapa del éxodo</a></p>
           <p><a href="#" onclick="abrirModal('https://i.imgur.com/5w9LMZx.png')">Tribus de Israel (tiempo de los reyes)</a></p>
        <p><a href="#" onclick="abrirModal('https://i.imgur.com/5w9LMZx.png')">Tierra de Israel en el Primer siglo</a></p>
        <p><a href="#" onclick="abrirModal('https://i.imgur.com/95ex03o.png')">Viajes de Saul (Pablo)</a></p>
        <p><a href="#" onclick="abrirModal('https://i.imgur.com/BiTNN4L.png')">Lugares donde Yehoshúa' vivió y enseñó</a></p>
        </div>
   
</div>

  </div>

<!-- Sidebar paralelo -->
<div id="paraleloSidebar" class="col-md-6 col-lg-4 mb-3">


   <div class="dropdown-container">
  
        <!-- Dropdown de versiones -->
        <div id="versionDropdown" class="dropdown">
          <label for="versionSelector" class="dropdown-label">Versión:</label>
          <select id="versionSelector" class="version-dropdown" onchange="cambiarVersion()">
            <option value="RVR1960">Reina-Valera 1960</option>
            <option value="Americas">Las Américas</option>
            <option value="Jubileos">Biblia Jubileos</option>
          </select>
        </div>

        <!-- Dropdown de libros -->
        <div id="bookDropdown" class="dropdown"class="mb-3">
          <label for="bookSelector" class="dropdown-label">Libro:</label>
          <select id="bookSelector" class="book-dropdown" onchange="cargarCapitulos()">
            <option value="">Selecciona un libro</option>
          </select>
        </div>

        <!-- Dropdown de capítulos -->
        <div id="chapterDropdown" class="dropdown" class="mb-3">
          <label for="chapterSelector" class="form-label">Capítulo:</label>
          <select id="chapterSelector" class="chapter-dropdown" onchange="mostrarCapitulo()">
            <option value="">Selecciona un capítulo</option>
          </select>
        </div>

       <!-- Contenedor para contenido de capítulos --></div>
      <div id="chapterContentSidebar" class="mt-3 p-3" style= "margin-top: 3px; color: white; padding: 10px; overflow-y: auto; max-height: 450px;"></div>
    </div>

    



<!-- el error radica en los cierres del paralelosidebar y mysidebar en medio -->


    <!-- Modal -->
    <div id="modal" class="modal" style="display:none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8);">
      <span class="close" onclick="cerrarModal()" style="color: white; position: absolute; top: 10px; right: 20px; cursor: pointer; font-size: 2rem;">&times;</span>
      <img id="modalImg" class="modal-content" alt="Imagen" style="margin: auto; display: block; max-width: 90%; max-height: 90%;">
      <div id="caption" style="color: white; text-align: center; padding: 10px;"></div>
    </div>
  





<!-- Mensaje de bienvenida -->
<div id="welcomeMessage" class="col-12 text-center mb-4">
  <h2>¡Bienvenido al Buscador de Versículos Bíblicos!</h2>
  <p>Escribe el libro, capítulo y versículo que deseas buscar.</p>
</div>

<!-- Resultados generales -->
<ul id="results" style="margin-top:-23px;" class="list-group col-12 mt-3" ></ul>




<script>



  // Función para mostrar el primer capítulo de un libro
async function showFirstChapter(libro) {
    currentBook = libro; // Actualizar el libro actual
    const datos = await fetchAllJsonData();
    if (!datos || !datos[libro]) {
        resultsContainer.innerHTML = "<li>Libro no encontrado.</li>";
        return;
    }

    const capitulos = datos[libro];
    const primerCapitulo = Object.keys(capitulos)[0]; // Obtener el primer capítulo
    currentChapter = primerCapitulo; // Actualizar el capítulo actual
    const versos = capitulos[primerCapitulo];

    // Limpiar resultados y mostrar los versos del primer capítulo
    resultsContainer.innerHTML = ""; // Elimina cualquier encabezado
    Object.entries(versos).forEach(([versiculo, texto]) => {
        resultsContainer.innerHTML += `<li>${libro} ${primerCapitulo}:${versiculo} - ${texto}</li>`;
    });

    // Actualizar navegación
    showFullChapter(libro, primerCapitulo);

    // Ocultar mensaje de bienvenida y mostrar resultados
    hideWelcomeMessage();
    sidebar.style.display = "block";

      // **Actualizar comentarios**
    cargarComentariosCapitulo(libro, primerCapitulo);
}



// Añadir evento a cada opción del menú desplegable
document.querySelectorAll("#dropdownMenu a").forEach(item => {
  item.addEventListener("click", event => {
    event.preventDefault();
    const libro = item.getAttribute("data-libro"); // Obtener el libro seleccionado
    if (libro) {
      showFirstChapter(libro);
    }
  });
});

   
 const prevPageButton = document.getElementById("prevPage");
  const nextPageButton = document.getElementById("nextPage");

  async function showFullChapter(libro, capitulo) {
    currentBook = libro; // Actualizar el libro actual
    currentChapter = capitulo; // Actualizar el capítulo actual
    const datos = await fetchAllJsonData();
    if (!datos[libro] || !datos[libro][capitulo]) return;

    resultsContainer.innerHTML = "";

    Object.entries(datos[libro][capitulo]).forEach(([numVerso, texto]) => {
        resultsContainer.innerHTML += `<li>${libro} ${capitulo}:${numVerso} - ${texto}</li>`;
    });

    // Determinar capítulos anterior y siguiente
    const chapterNumbers = Object.keys(datos[libro]).map(Number).sort((a, b) => a - b);
    const currentChapterIndex = chapterNumbers.indexOf(parseInt(capitulo));

    const prevChapter = chapterNumbers[currentChapterIndex - 1];
    const nextChapter = chapterNumbers[currentChapterIndex + 1];

    // Mostrar u ocultar botones según disponibilidad
    if (prevChapter) {
        prevPageButton.style.display = "inline-block";
        prevPageButton.onclick = () => showFullChapter(libro, prevChapter);
    } else {
        prevPageButton.style.display = "none";
    }

    if (nextChapter) {
        nextPageButton.style.display = "inline-block";
        nextPageButton.onclick = () => showFullChapter(libro, nextChapter);
    } else {
        nextPageButton.style.display = "none";
    }

    // Cargar comentarios dinámicos para el capítulo actual
    cargarComentariosCapitulo(libro, capitulo);
}

 const toggleButton = document.getElementById("toggleComentarios");
const comentariosDiv = document.getElementById("comentarios");
const contenidoComentarios = document.getElementById("contenidoComentarios");

toggleButton.addEventListener("click", () => {
    // Alternar visibilidad
    if (comentariosDiv.style.display === "none") {
        comentariosDiv.style.display = "block";
        toggleButton.textContent = "Ocultar Comentarios";
        cargarComentariosCapitulo(currentBook, currentChapter); // Carga comentarios del capítulo actual
    } else {
        comentariosDiv.style.display = "none";
        toggleButton.textContent = "Mostrar Comentarios";
    }
});

function cargarComentarios() {
    const url = `https://raw.githubusercontent.com/Angelos2024/torah-Yehoshua/main/comentarios_codigos/galatas/galatas1.html`;

    contenidoComentarios.innerHTML = "Cargando comentarios...";

    fetch(url)
        .then(response => {
            if (!response.ok) {
                throw new Error(`Error al cargar el archivo: ${response.status}`);
            }
            return response.text();
        })
        .then(data => {
            contenidoComentarios.innerHTML = data; // Inserta el contenido dinámico
        })
        .catch(error => {
            contenidoComentarios.innerHTML = `<p>Error al cargar los comentarios: ${error.message}</p>`;
        });
}


  
</script>

    <script>
      // Funciones del sidebar
function toggleSidebar() {
  const sidebar = document.getElementById("mySidebar");
  const main = document.getElementById("main");
  const toggleNav = document.getElementById("toggleNav");
  const isOpen = sidebar.classList.contains("open");
  if (isOpen) {
    sidebar.classList.remove("open");
    main.classList.remove("shifted");
    toggleNav.src = "https://i.imgur.com/oJRwGnT.png"; // Ícono de menú
  } else {
    sidebar.classList.add("open");
    main.classList.add("shifted");
    toggleNav.src = "https://i.imgur.com/oJRwGnT.png"; // Sustituye por un enlace válido de tu imagen de cierre
  }
}
  
  // JSON y búsqueda
  const urls = [
    "https://raw.githubusercontent.com/Angelos2024/torah-Yehoshua/main/galatas.json",
    "https://raw.githubusercontent.com/Angelos2024/torah-Yehoshua/main/Hebreos.json",
    "https://raw.githubusercontent.com/Angelos2024/torah-Yehoshua/main/1_Tesalonicenses.json"
  ];
  const searchInput = document.getElementById("searchInput");
  const searchButton = document.getElementById("searchButton");

  const resultsContainer = document.getElementById("results");
  const countResultsContainer = document.getElementById("countResults");
  const sidebar = document.getElementById("myDIV");

  const dropdownButton = document.getElementById("dropdownButton");
  const dropdownMenu = document.getElementById("dropdownMenu");

  // Función para cargar datos JSON

 async function fetchJsonData(url) {
    try {
      const response = await fetch(url);
      if (!response.ok) throw new Error(`Error al cargar JSON: ${response.status}`);
      return await response.json();
    } catch (error) {
      console.error(`Error:`, error);
      return null;
    }
  }

  async function fetchAllJsonData() {
    const allData = {};
    for (const url of urls) {
      const data = await fetchJsonData(url);
      if (data) Object.assign(allData, data);
    }
    return allData;
  }

// Función de búsqueda principal
async function searchVerses(query) {
  const datos = await fetchAllJsonData();
  if (!datos) return;


 // Mostrar la palabra buscada en el contenedor
  const searchTermContainer = document.getElementById("searchTermContainer");
  searchTermContainer.innerHTML = `Busqueda: <span style="color: #007bff;">${query}</span>`;


  resultsContainer.innerHTML = "";
  countResultsContainer.innerHTML = "";
  prevPageButton.style.display = "none"; // Ocultar botón "Anterior"
  nextPageButton.style.display = "none"; // Ocultar botón "Siguiente"

  const normalizedQuery = query
    .normalize("NFD")
    .replace(/[\u0300-\u036f]/g, "")
    .toLowerCase();

  // Mapear abreviaturas a nombres completos
  const libroMap = {
    gal: "gálatas", Gal: "Gálatas",
    heb: "hebreos", Heb: "Hebreos",
    "1 tes": "1Tesalonicenses", "1tes": "1Tesalonicenses",
    "1 tesa": "1Tesalonicenses", "1Tesa": "1Tesalonicenses",
    "1 tesalonicenses": "1Tesalonicenses"
  };

  // Verificar si es una búsqueda de versículos específicos o capítulos completos
  const match = normalizedQuery.match(/^([\w\s]+)\s(\d+)(?::(\d+)(?:-(\d+))?)?$/);
  if (match) {
    let libro = match[1].trim();
    const capitulo = match[2];
    const versiculoInicio = match[3] ? parseInt(match[3], 10) : null;
    const versiculoFin = match[4] ? parseInt(match[4], 10) : null;

    libro = libroMap[libro] || libro;
    const libroEncontrado = Object.keys(datos).find(key => {
      return key
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .toLowerCase() === libro
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .toLowerCase();
    });

    if (libroEncontrado) {
      const capitulos = datos[libroEncontrado];
      if (capitulos[capitulo]) {

        // Lógica de versículo o rango
        if (versiculoInicio && versiculoFin) {
          for (let i = versiculoInicio; i <= versiculoFin; i++) {
            const texto = capitulos[capitulo][i];
            resultsContainer.innerHTML += texto
              ? `<li>${libroEncontrado} ${capitulo}:${i} - ${texto}
                  <a href="#" class="full-chapter-link" onclick="showFullChapter('${libroEncontrado}', '${capitulo}')">Leer capítulo completo</a>
                 </li>`
              : `<li>${libroEncontrado} ${capitulo}:${i} - Versículo no encontrado.</li>`;
          }
          return;
        } else if (versiculoInicio) {
          const texto = capitulos[capitulo][versiculoInicio];
          resultsContainer.innerHTML = texto
            ? `<li>${libroEncontrado} ${capitulo}:${versiculoInicio} - ${texto}
              <a href="#" class="full-chapter-link" onclick="showFullChapter('${libroEncontrado}', '${capitulo}')">Leer capítulo completo</a>
            </li>`
            : `<li>${libroEncontrado} ${capitulo}:${versiculoInicio} - Versículo no encontrado.</li>`;
          return;
        } else {
          showFullChapter(libroEncontrado, capitulo);
          cargarComentariosCapitulo(libroEncontrado, capitulo);
          return;
        }
      } else {
        resultsContainer.innerHTML = "<li>Capítulo no encontrado.</li>";
        return;
      }
    } else {
      resultsContainer.innerHTML = "<li>Libro no encontrado.</li>";
      return;
    }
  }

  const resultados = [];
  const conteoPorLibro = {};
  const ubicacionesPorLibro = {};
  const palabraRegex = new RegExp(`(${query})`, "gi");

  Object.keys(datos).forEach(libro => {
    let libroCount = 0;
    ubicacionesPorLibro[libro] = [];
    Object.keys(datos[libro]).forEach(capitulo => {
      Object.entries(datos[libro][capitulo]).forEach(([versiculo, texto]) => {
        const textoNormalizado = texto
          .normalize("NFD")
          .replace(/[\u0300-\u036f]/g, "")
          .toLowerCase();
        if (textoNormalizado.includes(normalizedQuery)) {
          const textoResaltado = texto.replace(
            palabraRegex,
            "<span style='background-color: #333; color: white; font-weight: bold;'>$1</span>"
          );
          resultados.push(
            `<li>${libro} ${capitulo}:${versiculo} - ${textoResaltado}
              <span class="full-chapter-link" onclick="showFullChapter('${libro}', '${capitulo}')">Leer capítulo completo</span></li>`
          );
          libroCount++;
          ubicacionesPorLibro[libro].push(`${capitulo}:${versiculo}`);
        }
      });
    });
    if (libroCount > 0) {
      conteoPorLibro[libro] = libroCount;
    }
  });

  Object.entries(conteoPorLibro).forEach(([libro, count]) => {
    const ubicaciones = ubicacionesPorLibro[libro]
      .map(
        ubicacion => `<li><a href="#" onclick="showVerse('${libro}', '${ubicacion}')">${libro} ${ubicacion}</a></li>`
      )
      .join("");
    countResultsContainer.innerHTML += `<li class="expandable">${libro} (${count})<ul class="nested">${ubicaciones}</ul></li>`;
  });

  if (resultados.length > 0) {
    resultsContainer.innerHTML = resultados.join("");
  } else {
    resultsContainer.innerHTML = "<li>No se encontraron coincidencias.</li>";
  }

  sidebar.style.display = resultados.length > 0 ? "block" : "none";
  document.querySelectorAll(".expandable").forEach(item => {
    item.addEventListener("click", function () {
      this.querySelector(".nested").style.display =
        this.querySelector(".nested").style.display === "block" ? "none" : "block";
    });
  });
}


// Función para cargar comentarios según el capítulo
function cargarComentariosCapitulo(libro, capitulo) {
  const comentariosURLs = {
    "Gálatas": {
      1: "https://raw.githubusercontent.com/Angelos2024/torah-Yehoshua/main/comentarios_codigos/galatas/galatas1.html",
      2: "https://raw.githubusercontent.com/Angelos2024/torah-Yehoshua/main/comentarios_codigos/galatas/galatas2.html"
    },
    "Hebreos": {
      5: "https://raw.githubusercontent.com/Angelos2024/torah-Yehoshua/main/comentarios_codigos/hebreos/hebreos5.html"
    }
  };

  const url = comentariosURLs[libro]?.[capitulo];
  const contenedor = document.getElementById("contenidoComentarios");

  if (!url) {
    contenedor.innerHTML = "<p>Comentarios no disponibles para este capítulo.</p>";
    return;
  }

  contenedor.innerHTML = "Cargando comentarios...";
  fetch(url)
    .then(response => {
      if (!response.ok) {
        throw new Error(`Error al cargar el archivo: ${response.status}`);
      }
      return response.text();
    })
    .then(data => {
      contenedor.innerHTML = data;
    })
    .catch(error => {
      contenedor.innerHTML = `<p>Error al cargar los comentarios: ${error.message}</p>`;
    });
}



// Funciones auxiliares: showVerse, showFullChapter, etc. permanecen iguales


function showVerse(libro, ubicacion) {
    const [capitulo, versiculo] = ubicacion.split(":");
    fetchAllJsonData().then(datos => {
        if (!datos[libro] || !datos[libro][capitulo]) return;
        const texto = datos[libro][capitulo][versiculo];
        resultsContainer.innerHTML = texto
            ? `<li>${libro} ${capitulo}:${versiculo} - ${texto}
               <br>
               <a href="#" onclick="showFullChapter('${libro}', '${capitulo}')" class="full-chapter-link">Leer capítulo completo</a>
               </li>`
            : `<li>${libro} ${capitulo}:${versiculo} - Versículo no encontrado.</li>`;
    });
    // Ocultar botones de navegación
  prevPageButton.style.display = "none";
  nextPageButton.style.display = "none";
}




function showFullChapterWithHighlight(libro, capitulo, versiculoResaltado) {
    fetchAllJsonData().then(datos => {
        if (!datos[libro] || !datos[libro][capitulo]) return;
        const versiculos = Object.entries(datos[libro][capitulo])
            .map(([versiculo, texto]) => {
                if (versiculo === versiculoResaltado) {
                    return `<li style="background-color: #666; color: white; font-weight: bold; font-family: Arial, sans-serif; transition: background-color 0.3s ease;" 
            onmouseover="this.style.backgroundColor='#000'" 
            onmouseout="this.style.backgroundColor='#666'" 
            data-temporary="true" 
            onmouseenter="if (this.dataset.temporary === 'true') {
              setTimeout(() => { 
                this.style.backgroundColor = '#fff'; 
                this.style.color = '#333'; 
                this.style.fontWeight = 'normal'; 
                this.style.padding = '15px'; 
                this.style.border = '1px solid #ccc'; 
                this.style.marginBottom = '-13px'; 
                this.style.borderRadius = '4px'; 
                this.style.width = 'calc(100% + 80px)'; 
                this.style.marginLeft = '-90px'; 
                this.style.marginTop = '20px'; 

                // Elimina los eventos de hover
                this.removeAttribute('onmouseover');
                this.removeAttribute('onmouseout');
                this.dataset.temporary = 'false'; // Desactiva el estilo temporal
              }, 5000);
            }">
            ${libro} ${capitulo}:${versiculo} - ${texto}
        </li>`;


                }
                return `<li>${libro} ${capitulo}:${versiculo} - ${texto}</li>`;
            })
            .join("");
        resultsContainer.innerHTML = versiculos || "<li>Capítulo no encontrado.</li>";
    });
}



      searchButton.addEventListener("click", () => {
    const query = searchInput.value.trim();
    if (query) searchVerses(query);
  });

  searchInput.addEventListener("keypress", event => {
    if (event.key === "Enter") {
      const query = searchInput.value.trim();
      if (query) searchVerses(query);
    }
  });


      // Ocultar el mensaje de bienvenida al realizar una búsqueda
const welcomeMessage = document.getElementById("welcomeMessage");
function hideWelcomeMessage() {
  welcomeMessage.style.display = "none";
}
searchButton.addEventListener("click", () => {
  const query = searchInput.value.trim();
  if (query) {
    hideWelcomeMessage();
    searchVerses(query);
  }
});
searchInput.addEventListener("keypress", event => {
  if (event.key === "Enter") {
    const query = searchInput.value.trim();
    if (query) {
      hideWelcomeMessage();
      searchVerses(query);
    }
  }
});

   function displayChapter(libro, capitulo) {
    fetchAllJsonData().then(datos => {
      if (!datos[libro] || !datos[libro][capitulo]) return;
      resultsContainer.innerHTML = "";
      Object.entries(datos[libro][capitulo]).forEach(([numVerso, textoVerso]) => {
        resultsContainer.innerHTML += `<li>${libro} ${capitulo}:${numVerso} - ${textoVerso}</li>`;
      });
    });
  }

function mostrarSeccion(seccion) {
  const secciones = document.querySelectorAll(".seccionSidebar");
  secciones.forEach(sec => (sec.style.display = "none")); // Oculta todas las secciones
  const seccionSeleccionada = document.getElementById(seccion);
  if (seccionSeleccionada) {
    seccionSeleccionada.style.display = "block"; // Muestra la sección seleccionada
  }
}
function copiarContenido() {
  const resultados = document.getElementById("results");
  const texto = resultados.innerText; // Obtiene el texto de los resultados
  if (texto) {
    navigator.clipboard.writeText(texto).then(() => {
      alert("El contenido ha sido copiado.");
    }).catch(err => {
      console.error("Error al copiar.", err);
    });
  } else {
    alert("No hay contenido para copiar.");
  }
}

      // Funcionalidad del menú desplegable
      dropdownButton.addEventListener("click", () => {
        const isMenuVisible = dropdownMenu.style.display === "block";
        dropdownMenu.style.display = isMenuVisible ? "none" : "block";
      });
      document.addEventListener("click", event => {
        if (!dropdownButton.contains(event.target)) {
          dropdownMenu.style.display = "none";
        }
      });


const state = {
  currentBook: null,
  currentChapter: null,
};

// Al acceder o actualizar
state.currentBook = libro;
state.currentChapter = capitulo;

// Función para alternar el nuevo sidebar
    </script>
   <script src="js/scriptparalelo.js"></script>



  </body>
</html>
